---
title: "Project 3: Aim 1"
subtitle: Prediction of Gene Function using Phylogenetic Trees<br><text style="font-size:80%; color:darkgray">IMAGE Retreat 2023</text>
bibliography: bibliography.bib
author: 
    - '**George G. Vega Yon**'
    - Paul Thomas
    - Paul Marjoram
    - Huaiyu Mi
    - Christopher Williams
affiliation: The University of Utah<br>Division of Epidemiology
date: 2023-06-05
format:
  revealjs:
    embed-resources: true
    fig-format: svg
    fig-align: center
    # toc: true
    slide-number: true
    citeproc: true
    citations-hover: true
    # smaller: true
    css: styles.css
    transition: convex
    footer: George G. Vega Yon -- [ggv.cl/slides/image-retreat2023](https://ggv.cl/slides/image-retreat2023)
    title-slide-attributes: 
      data-background-color: darkred
---

::: {.columns}
::: {.column width="20%"}
![](bio/george.png){width="auto" fig-align="center"}
:::

<!-- Paul T -->
::: {.column width="20%"} 
![](https://dornsife.usc.edu/assets/sites/681/imgs/4x5/PaulheadshotCropped.jpg){width="auto" fig-align="center"}
:::

<!-- Paul M -->
::: {.column width="20%"} 
![](https://i.pinimg.com/280x280_RS/ad/11/61/ad11616ca0747c7c151dee810817e109.jpg){width="auto" fig-align="center"}
:::


<!-- Huaiyu -->
::: {.column width="20%"} 
![](bio/huiayu.png){width="auto" fig-align="center"}
:::

::: {.column width="20%"}
![](bio/christopher.jpeg){width="auto" fig-align="center"}
:::

:::

You can download the slides from
<https://ggv.cl/image-retreat2023>



# Recap {background-color="black"}

## Starting point

::: {style="font-size: 70%"}

::: {.column width="45%"}

::: {.fragment .fade-up}
- In 2021, we published [our paper](https://doi.org/10.1371/journal.pcbi.1007948){target="_blank"}

> "Bayesian Parameter Estimation for Automatic Annotation of Gene Functions Using Observational Data and Phylogenetic Trees" -- [@VegaYon2021]

using phylogenetic trees to predict gene function.
:::

::: {.fragment .fade-up}
- Simple model using Felsenstein's pruning algorithm.
:::

::: {.fragment .fade-up}
- Assumes that genes' functions evolve independently.
:::
:::

::: {.column width="45%"}
![](fig/example-tree-aphylo.svg){width="auto"}
:::

:::



## Models in the project

::: {style="font-size: 65%"}

The key difference between the models is how they model the transition from parent to offspring: $\mathbb{P}\left(x_n\to x_o\right)$

::: {.column width="25%" .rectangle .fragment .fade-up fragment-index="1"}
<text style="font-size:200%;font-weight:bold">[aphylo {{< fa brands r-project >}}](https://cran.r-project.org/package=aphylo)</text>

- Fixed gain/loss rates.

- Full independence between genes/functions.

![](fig/aphylo-equation-transition.svg){width="100%"}
:::

::: {.column width="25%" .rectangle .fragment .fade-up fragment-index="3"}
<text style="font-size:200%;font-weight:bold">[aphylo2 {{< fa brands github >}}](https://github.com/UofUEpiBio/aphylo2)</text>

- Event-specific gain/loss rates.

- Full independence between genes/functions.

![](fig/aphylo2-equation-transition.svg){width="100%"}
:::

::: {.column width="25%" .rectangle .fragment .fade-up fragment-index="2"}
<text style="font-size:200%;font-weight:bold">[GEESE {{< fa brands github >}}](https://github.com/USCbiostats/geese)</text>

- Event-specific gain/loss rates.

- Jointly distributed model.

![](fig/geese-equation-transition.svg){width="100%"}
:::


![](fig/aphylo-data-probability.svg){width="auto" fig-align="center"}
:::

## Evol. of Gene fun. (multiple functions) Tapping into Evol. Theory  

::: {style="font-size: 70%"}

::: {.fragment .fade-up}
- A fundamental part of Fun. Evol. is Duplication Events.
:::

::: {.fragment .fade-up}
- Furthermore, knowing what happened to gene A (*e.g.*,
  neofunctionalization) is highly informative to learn about the
  functional state of B.
:::

::: {.fragment .fade-up}
- One way to model this is using a Markov Transition Model (as in
  SIFTER [@Engelhardt2011]).
:::

:::

![A key part of molecular innovation, gene duplication provides an opportunity for new functions to emerge (<a href="https://en.wikipedia.org/wiki/File:Evolution_fate_duplicate_genes_-_vector.svg">wikimedia</a>)](fig/Evolution_fate_duplicate_genes_-_vector.svg){width="80%" fig-align="center"}


## GEESE: **GE**ne functional **E**volution using **S**ufici**E**ncy

::: {style="font-size: 70%"}

Model fully implemented in C++ and R. It already shows great promise:

![](fig/mcmc-analysis-unif-prior-curated-auc-and-mae.svg){width="auto" fig-align="center"}

:::

# Challenges {background-color="black"}


## Rough edges

::: {style="font-size: 70%"}

::: {.fragment .fade-up}
### We have only discussed Sub Aim 2

- Sub Aim 1 is supposed to deal with the **Hierarchical Bayesian Framework**.

- Some work is done, but we need a leader for this.
:::

::: {.fragment .fade-up}
### Data challenges
- Most trees aren't fully-reconciled: GEESE's complexity grows exponentially with the number of offspring in the tree.

- Negative assertions (gene `NOT` associated with) are rare... but Christopher has made good progress using taxon constraints.
:::

:::

# Discussion {background-color="black"}

## Goals

::: {style="font-size: 70%"}

::: {.fragment .fade-up}

### Manuscripts

- The GEESE paper is about 80% done. We ~~need to~~will finish it this year.

- Low-hanging fruit: aphylo2 can be submitted to PLOS Comp. Bio. using aphylo (a software prototype is up and running).
:::

::: {.fragment .fade-up}
### Collaboration (ideas)

- Augment -omics data with GEESE (*Ã  la carte*): Use GEESE on a gene list to make predictions, then use those predictions as additional -omics data.

```{mermaid}
%%| fig-width: 100%
%%| eval: false
graph LR
  a["Proj. X has a<br>gene list"]-->b["We can<br>map the list to<br>Panther and GO"]
  b --> c[We make<br>predictions<br>using GEESE]
  c --> d[GEESE<br>predictions<br>are used in Proj. X]
  
  %%classDef mybox fill:darkred,color:#fff,stroke:white,stroke-width:0px;
  %%class a,b,c,d mybox;
```

- GEESE is built on top of Discrete Exponential-Family Models (DEMs). We could use them to model other things (**e.g.**, correlated binary outcomes) [@vegayonDiscreteExponentialFamilyModels2022].
:::

:::

## Bonus: Mechanistic ML (prelim res.) 

Not mentioned in the original grant, but we could add it to (any) the project.

![](fig/logit-aucs-ols-geese.svg){width="auto" fig-align="center"}


## References