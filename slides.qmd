---
title: "Project 3: Aim 1"
subtitle: Prediction of Gene Function using Phylogenetic Trees<br><text style="font-size:80%; color:darkgray">IMAGE Retreat 2023</text>
bibliography: bibliography.bib
author: 
    - '**George G. Vega Yon**'
    - Paul Thomas
    - Paul Marjoram
    - Huaiyu Mi
    - Christopher Williams
affiliation: The University of Utah<br>Division of Epidemiology
date: 2023-06-05
format:
  revealjs:
    embed-resources: true
    fig-format: svg
    fig-align: center
    # toc: true
    slide-number: true
    citeproc: true
    citations-hover: true
    # smaller: true
    css: styles.css
    transition: convex
    footer: George G. Vega Yon -- [ggv.cl/slides/image-retreat2023](https://ggv.cl/slides/image-retreat2023)
    title-slide-attributes: 
      data-background-color: darkred
---

You can download the slides from
<https://ggv.cl/image2023>

# Recap {background-color="black"}

## Starting point

::: {style="font-size: 70%"}

::: {.column width="45%"}

::: {.fragment .fade-up}
- In 2021, we published our paper 

> "Bayesian Parameter Estimation for Automatic Annotation of Gene Functions Using Observational Data and Phylogenetic Trees" -- [@VegaYon2021]

using phylogenetic trees to predict gene function.
:::

::: {.fragment .fade-up}
- Simple model using Felsenstein's pruning algorithm.
:::

::: {.fragment .fade-up}
- Assumes that genes' functions evolve independently.
:::
:::

::: {.column width="45%"}
![](fig/example-tree-aphylo.svg){width="auto"}
:::


:::

## Models in the project 

::: {style="font-size: 70%"}

The key difference between the models is how they model the transition from parent to offspring: $\mathbb{P}\left(x_n\to x_o\right)$

::: {.column width="25%" .rectangle .fragment .fade-up fragment-index="1"}
<text style="font-size:200%;font-weight:bold">aphylo</text>

- Fixed gain/loss rates.

- Full independence between genes/functions.

![](fig/aphylo-equation-transition.svg){width="100%"}
:::

::: {.column width="25%" .rectangle .fragment .fade-up fragment-index="3"}
<text style="font-size:200%;font-weight:bold">aphylo2</text>

- Event-specific gain/loss rates.

- Full independence between genes/functions.

![](fig/aphylo2-equation-transition.svg){width="100%"}
:::

::: {.column width="25%" .rectangle .fragment .fade-up fragment-index="2"}
<text style="font-size:200%;font-weight:bold">GEESE</text>

- Event-specific gain/loss rates.

- Jointly distributed model.

![](fig/geese-equation-transition.svg){width="100%"}
:::


![](fig/aphylo-data-probability.svg){width="auto" fig-align="center"}
:::

## Evol. of Gene fun. (multiple functions) Tapping into Evol. Theory  

::: {style="font-size: 70%"}

::: {.fragment .fade-up}
- A fundamental part of Fun. Evol. is Duplication Events.
:::

::: {.fragment .fade-up}
- Furthermore, knowing what happened to gene A (*e.g.*,
  neofunctionalization) is highly informative to learn about the
  functional state of B.
:::

::: {.fragment .fade-up}
- One way to model this is using a Markov Transition Model (as in
  SIFTER [@Engelhardt2011]).
:::

:::

![A key part of molecular innovation, gene duplication provides an opportunity for new functions to emerge (<a href="https://en.wikipedia.org/wiki/File:Evolution_fate_duplicate_genes_-_vector.svg">wikimedia</a>)](fig/Evolution_fate_duplicate_genes_-_vector.svg){width="80%" fig-align="center"}


## GEESE: **GE**ne functional **E**volution using **S**ufici**E**ncy

::: {style="font-size: 70%"}

Model fully implemented in C++ and R. It already shows great promise:

![](fig/mcmc-analysis-unif-prior-curated-auc-and-mae.svg){width="auto" fig-align="center"}

:::

# Bonus slides {background-color="black"}

## Mechanistic ML (prelim res.)


![](fig/logit-aucs-ols-geese.svg){width="auto" fig-align="center"}

Both AUC and MAE were computed only using predictions for which we knew
the true value.


## Discussion

---

Thank you!

## References


## Phylogenetics Modeling Strategies

<figure>
<embed srd="fig/phylo-model-overview-legend.pdf" />
</figure>

## Evolution of Gene function (multiple functions)

If we wanted to build a model with 3 functions, we would need to
estimate...  

